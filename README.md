# DJ Timekeeper Pro

Firebase (Firestore / Storage) をバックエンドにした、DJイベント用のリアルタイム・タイムテーブル管理アプリです。
編集モードとLiveモードでデータを瞬時に同期します。

## 主な機能

- **直感的な編集モード**: DJの追加、削除、順番の入れ替え、時間の調整をドラッグ＆ドロップで直感的に行えます。
- **高機能なLiveモード**: 現在再生中のDJ、残り時間、次のDJを全画面で表示する本番用ビューです。
- **リアルタイム同期**: Firebase Firestore を使用し、編集モードでの変更が即座にLiveモードに反映されます。
- **閲覧専用モード**: URLの末尾に `/#live` をつけることで、編集権限のない閲覧専用のLiveモードとして共有可能です。
- **画像アップロード＆圧縮**: DJのアイコンをアップロード可能。クライアントサイドで自動的に圧縮・リサイズされるため、高速に表示されます。
- **レスポンシブ対応**: PCでもスマホ（iPhone SEなど）でも最適化されたレイアウトで表示されます。
- **テーマ切り替え**: ライトモードとダークモードに対応。閲覧者のデバイス設定（`localStorage`）に保存されます。
- **スリープ防止**: Liveモード中は `WakeLock API` を使用し、デバイスが自動でスリープするのを防ぎます。

## 使い方

### 編集モード ( `/` )

アプリのメイン画面（`/`）です。ここでタイムテーブルのすべてを管理します。

- **イベント設定**: イベントタイトルと、全体の**開始時間**を設定できます。
- **DJを追加**: DJ名、持ち時間（分）、イメージカラー、アイコン画像（アップロード or URL指定）を設定してDJを追加します。
- **バッファーを追加**: DJ間の転換時間として「バッファー」を追加できます。
- **並び替え**: DJの左側にあるグリップアイコンを掴んで、ドラッグ＆ドロップで順番を入れ替えられます。
- **コピー・削除**: 各DJアイテムのボタンから、DJの複製や削除が可能です。
- **Liveモードへ**: タイムテーブルが完成したら、右上の「Liveモード」ボタンで本番用画面に切り替えられます。

### Liveモード ( `/#live` )

本番中にフロアのスクリーンなどに映し出すためのビューです。
編集モードのヘッダーにある「共有」ボタンから、閲覧専用URL（`/#live`）をコピーできます。

- **現在のDJ**: 現在のDJ名と残り時間が大きく表示されます。
- **次のDJ**: 「NEXT UP」として次のDJ名と開始時刻が表示されます。
- **ダイナミック背景**: 現在再生中のDJのテーマカラーが、背景にグラデーションで表示されます。
- **リアルタイムタイムライン**: 画面下部には、現在のDJが中央に来るように自動スクロールするタイムラインが表示されます。
- **メニュー**: ヘッダーのメニューから「全体を見る」モーダルを開いたり、編集モードに戻ったり（管理者のみ）できます。

## 技術仕様

- **フロントエンド**: React (Vite + SWC)
- **スタイリング**: Tailwind CSS (ライト/ダークモード対応)
- **バックエンド (BaaS)**: Firebase
  - **認証**: 匿名認証 (Anonymous Authentication)
  - **データベース**: Firestore (リアルタイム同期用)
  - **ストレージ**: Firebase Storage (アイコン画像アップロード用)
- **状態管理＆ロジック**: React Hooks
  - `useTimetable.js`: タイムテーブルの計算・更新ロジック
  - `useDragAndDrop.js`: D&Dの座標計算・並び替えロジック
  - `useStorageUpload.js`: 画像圧縮・アップロードロジック
  - `useImagePreloader.js`: Liveモードでの画像先行読み込みロジック

## セットアップ方法

### 1. Firebase プロジェクトの準備

このアプリはFirebaseに強く依存しているため、Firebaseプロジェクトのセットアップが必須です。

1.  Firebaseコンソールで新しいプロジェクトを作成します。
2.  以下のサービスを有効にします。
    - **Authentication**: 「匿名認証」を有効にします。
    - **Firestore**: データベースを作成します（テスト環境のままのルールでOKです）。
    - **Storage**: ストレージを作成します（テスト環境のままのルールでOKです）。
3.  ウェブアプリを登録し、`firebaseConfig` オブジェクト（APIキーなどが含まれる）を取得します。

### 2. Firebase設定ファイルの編集

取得した `firebaseConfig` を `src/firebase.js` にコピペします。

```javascript
// src/firebase.js

// ... (import文) ...

// ここにご自身のFirebaseプロジェクトの設定を貼り付けてください
const firebaseConfig = {
  apiKey: "AIzaSy...",
  authDomain: "your-project.firebaseapp.com",
  projectId: "your-project",
  storageBucket: "your-project.appspot.com",
  messagingSenderId: "...",
  appId: "..."
};

// ... (以降の初期化コード) ...